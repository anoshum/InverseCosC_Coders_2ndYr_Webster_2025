<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Linking Bootstrap CSS for styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" 
    rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <title>Admin</title>
    <style type="text/tailwindcss">
        button{
          @apply bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded;
        }
        .logo{
            @apply font-bold text-2xl p-2;
        }
    </style>
</head>

<body style="bg-gradient-to-br from-emerald-200/60 via-teal-200/50 to-lime-100/60 backdrop-blur-2xl">

<!-- Navigation Bar Section -->
<header class="flex bg-[#970FF2] text-white p-2 justify-between m-2 rounded-lg">
        <div class="logo">FiksIt</div>
        
    </header>

<!-- Main Content Section -->
<div class="container-fluid">
  <div class="row">

    <!-- Complaint Overview & List Section -->
    <div class="p-3 col-12 rounded-2" style="height: 80vh;">
      
      <div class="container">
        <div class="row">
         
          <!-- ðŸ“‹ Left Column: List of All Complaints -->
          <div class="col-12" style="overflow:scroll; height: 70vh; background-color: azure;">
            <!-- Each complaint block is shown below -->
            <!-- Clicking a complaint will display its details on the right panel -->
             {% for comp in complains%}
          
          
            <div class="individual-complain mt-3">
              <div class="m-1 container-fluid bg-light p-3 rounded-3 border border-black border-1">
                <h5>{{ comp.domain_name}}</h5>
                <p class="lead">{{ comp.info}}</p>
                {%if comp.status == 'Pending'%}
                <button class="btn btn-danger">{{comp.status}}</button>
                {% endif %}
                {%if comp.status == 'Working'%}
                <button class="btn btn-warning">{{comp.status}}</button>
                {% endif %}
                {%if comp.status == 'Done'%}
                <button class="btn btn-primary">{{comp.status}}</button>
                {% endif %}
                <br />
                <br />
                <form action='upd' method='Post'>
                  {%csrf_token%}
                  <input type ='hidden' name='id' value='{{comp.id}}'>
                  <input type='submit' value='promote' class='btn btn-success'>
                </form>
                
                <p class="lead fw-bolder">By : {{ comp.user_name}}</p>
                <p class="lead fw-bolder">Date : {{ comp.datee}}</p>
                <img src= 'images/{{comp.image}}' style='width:70%;'class='border-3 border-danger  rounded-3'>
                
              </div>
            </div>

        {% endfor %}
          </div>
          

        </div>
      </div>
    </div>

    <!-- Map Section (for complaint heatmap visualization) -->
    <div>
        <div id="map" class="map bg-info h-96 m-4 rounded-2 p-2">
    </div>

  </div>
</div>

<!-- Complaint Category Buttons Section -->
<div class="text-lg-center container-fluid" style="background-color: rgb(207, 164, 247);">
  <div class="row lead p-3 text-white container-fluid">
    <div class="col-3">
      <form method='post' action='dmn'>
        {%csrf_token%}
        <input type ='hidden' name='cat' value='Sanitary'>
        <input type='submit' class="btn btn-primary btn-lg" value='Sanitary Complaints'>
      </form>
    </div>
    <div class="col-3">
      <form method='post' action='dmn'>
        {%csrf_token%}
        <input type ='hidden' name='cat' value='Civil'>
        <input type='submit' class="btn btn-secondary btn-lg" value='Civil Complaints'>
      </form>
    </div>
    <div class="col-3">
      <form method='post' action='dmn'>
        {%csrf_token%}
        <input type ='hidden' name='cat' value='Electricity'>
        <input type='submit' class="btn btn-warning btn-lg" value='Electricity Complaints'>
      </form>
    </div>
    <div class="col-3">
      <form method='post' action='dmn'>
        {%csrf_token%}
        <input type ='hidden' name='cat' value='Water'>
        <input type='submit' class="btn btn-success btn-lg" value='Water Complaints'>
      </form>
      </div>
  </div>
</div>
    
<!-- Footer Section -->
<footer class="bg-[#970FF2] text-white p-2 text-center">
    <div class="footer-content">
        <p>Made by team InverseCosC_Coders ðŸ˜Ž</p>
    </div>
<script>
        var map = L.map('map').setView([25.493668, 81.863350], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        // Step 3: List of nearby locations (latitude, longitude, name)
        var locations = [
        {% for comp in complains %}
        { name: "{{comp.landmark}}", lat: {{comp.locx}}, lon: {{comp.locy}} },
        
        {% endfor%}
        ];
        locations.forEach(function(place) {
            var marker = L.marker([place.lat, place.lon]).addTo(map);
            {% comment %} marker.bindPopup(`<b>${place.name}</b><br>Water Logging<br>Date`); {% endcomment %}
        
        });
  </script>
</body>
</html>
